import{u as G,a as X,C as J,s as H,b as Q,r as Y,g as Z,e as ee,f as se,q as b,t as D,v as g,w as re,j as e,h as F,B as y,I as u,S as ae}from"./index-tZeh5oqC.js";import{f as te,r as n}from"./react-vendor-BQWX9zlF.js";import{u as ne,a as oe,C as le}from"./form-vendor-BjD3cHyu.js";import{f as ce,i as ie,c as de,b as me}from"./useInView-DCIgkdnp.js";import{n as he,v as ue,f as pe,a as ge}from"./validation-B2toiAta.js";import{T as fe}from"./Textarea-Dj1tDlHU.js";import{S as xe}from"./Select-CdtHIgIb.js";import{S as je}from"./SEO-DmiMqMsU.js";import{R as $}from"./Reveal-CCPnqHKf.js";import"./redux-vendor-B8TTZsxA.js";import"./firebase-vendor-CGxEfUHl.js";const _e="_contacts_1nygq_1",be="_container_1nygq_6",ye="_title_1nygq_11",ve="_content_1nygq_19",ke="_infoCard_1nygq_25",Ne="_formCard_1nygq_26",Me="_contactItem_1nygq_37",Ie="_social_1nygq_63",Se="_socialLinks_1nygq_75",qe="_map_1nygq_91",we="_mapPlaceholder_1nygq_97",Ce="_mapNote_1nygq_109",Ee="_form_1nygq_26",Pe="_checkbox_1nygq_120",Te="_successMessage_1nygq_138",Be="_errorMessage_1nygq_147",Ae="_submitButton_1nygq_153",r={contacts:_e,container:be,title:ye,content:ve,infoCard:ke,formCard:Ne,contactItem:Me,social:Ie,socialLinks:Se,map:qe,mapPlaceholder:we,mapNote:Ce,form:Ee,checkbox:Pe,successMessage:Te,errorMessage:Be,submitButton:Ae},Oe=()=>{const t=G(),[v]=te(),{items:l,lastFetched:k,loading:z}=X(s=>s.procedures),{isSubmitting:N,success:f,error:M}=X(s=>s.booking),[a,R]=n.useState({...J,mapEmbedUrl:"",whatsappPhone:""}),{register:i,handleSubmit:W,formState:{errors:c},reset:I,setValue:x,control:S}=ne({defaultValues:{consent:!1}}),j=oe({control:S,name:"procedureId"}),q=n.useCallback(async()=>{t(H(!0));try{const s=await ce();t(Q(s))}finally{t(H(!1))}},[t]);n.useEffect(()=>{(l.length===0||ie(k,3e5))&&q()},[l.length,k,q]),n.useEffect(()=>{const s=v.get("procedureId");if(s&&l.length>0&&l.some(m=>m.id===s)){const m=setTimeout(()=>{x("procedureId",s,{shouldValidate:!0,shouldDirty:!0})},0);return()=>clearTimeout(m)}},[v,l,x]),n.useEffect(()=>{if(f){I();const s=setTimeout(()=>{t(Y())},5e3);return()=>clearTimeout(s)}},[f,I,t]),n.useEffect(()=>{let s=!0;return Z().then(o=>{s&&R(o)}).catch(()=>{}),()=>{s=!1}},[]);const V=n.useMemo(()=>l.map(s=>({value:s.id,label:`${s.name} - ${s.price} ₽`})),[l]),_=n.useMemo(()=>j&&l.find(o=>o.id===j)?.name||"",[l,j]),p=n.useMemo(()=>{if(a.whatsappEnabled===!1)return null;const s="Здравствуйте! Хочу записаться в A.K.beauty.",o=_?`${s} Процедура: "${_}".`:s;return ee({whatsappPhone:a.whatsappPhone,text:o})},[a.whatsappEnabled,a.whatsappPhone,_]),d=n.useMemo(()=>se({telegramLink:a.socialMedia.telegram}),[a.socialMedia.telegram]),w=n.useMemo(()=>b(a.socialMedia.instagram),[a.socialMedia.instagram]),C=n.useMemo(()=>b(a.socialMedia.vk),[a.socialMedia.vk]),E=n.useMemo(()=>b(a.socialMedia.whatsapp),[a.socialMedia.whatsapp]),U=n.useCallback(async s=>{const o=document.getElementById("hp_company")?.value;if(o&&o.trim().length>0){t(D());return}const m=Date.now(),T=localStorage.getItem("booking_last_submit_ts"),B=T?Number(T):0;if(B&&m-B<6e4){t(g("Пожалуйста, подождите минуту и попробуйте снова."));return}t(re());try{const h=he(s.phone);if(!h){t(g("Укажите телефон в формате +7 (XXX) XXX-XX-XX"));return}const A=(s.email??"").trim(),K={...s,phone:h,email:A||void 0},L=await de(K);L.success?(localStorage.setItem("booking_last_submit_ts",String(m)),t(D())):t(g(L.message||"Ошибка отправки"))}catch(h){t(g(h instanceof Error?h.message:"Произошла ошибка"))}},[t]),P=a.mapEmbedUrl||"",O=me(z&&l.length===0,160);return e.jsxs(e.Fragment,{children:[e.jsx(je,{title:"Контакты и запись",description:"Свяжитесь с нами или запишитесь на консультацию. Телефон, адрес, форма записи на сеанс.",keywords:"контакты косметолог, запись на процедуру, косметология контакты"}),e.jsx("div",{className:r.contacts,children:e.jsxs("div",{className:r.container,children:[e.jsx("h1",{className:r.title,children:"Контакты и запись"}),e.jsxs("div",{className:r.content,children:[e.jsx("div",{className:r.infoSection,children:e.jsx($,{children:e.jsxs(F,{className:r.infoCard,children:[e.jsx("h2",{children:"Контактная информация"}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Телефон:"}),e.jsx("a",{href:`tel:${a.phone}`,children:a.phone})]}),p&&e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"WhatsApp:"}),e.jsx("a",{href:p,target:"_blank",rel:"noopener noreferrer",children:"Написать в WhatsApp"})]}),d&&e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Telegram:"}),e.jsx("a",{href:d,target:"_blank",rel:"noopener noreferrer",children:"Написать в Telegram"})]}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Email:"}),e.jsx("a",{href:`mailto:${a.email}`,children:a.email})]}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Адрес:"}),e.jsx("p",{children:a.address})]}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Часы работы:"}),e.jsx("p",{children:a.workingHours})]}),e.jsxs("div",{className:r.social,children:[e.jsx("h3",{children:"Социальные сети"}),e.jsxs("div",{className:r.socialLinks,children:[w&&e.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",children:"Instagram"}),C&&e.jsx("a",{href:C,target:"_blank",rel:"noopener noreferrer",children:"VK"}),d&&e.jsx("a",{href:d,target:"_blank",rel:"noopener noreferrer",children:"Telegram"}),E&&e.jsx("a",{href:E,target:"_blank",rel:"noopener noreferrer",children:"WhatsApp"})]})]}),e.jsx("div",{className:r.map,children:P?e.jsx("iframe",{title:"Карта",src:P,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",style:{width:"100%",height:320,border:0,borderRadius:12}}):e.jsxs("div",{className:r.mapPlaceholder,children:[e.jsx("p",{children:"Карта местоположения"}),e.jsx("p",{className:r.mapNote,children:"Укажите VITE_MAP_EMBED_URL в .env.local (или заполните ссылку в админке → Контакты), чтобы встроить карту"})]})})]})})}),e.jsx("div",{className:r.formSection,children:e.jsx($,{delayMs:60,children:e.jsxs(F,{className:r.formCard,children:[e.jsx("h2",{children:"Записаться на сеанс"}),f&&e.jsxs("div",{className:r.successMessage,children:["✓ Ваша заявка успешно отправлена! Мы свяжемся с вами в ближайшее время.",p&&e.jsx("div",{style:{marginTop:12},children:e.jsx("a",{href:p,target:"_blank",rel:"noopener noreferrer",children:e.jsx(y,{variant:"outline",size:"small",children:"Написать в WhatsApp сейчас"})})}),d&&e.jsx("div",{style:{marginTop:12},children:e.jsx("a",{href:d,target:"_blank",rel:"noopener noreferrer",children:e.jsx(y,{variant:"outline",size:"small",children:"Написать в Telegram сейчас"})})})]}),M&&e.jsxs("div",{className:r.errorMessage,children:["✗ ",M]}),e.jsxs("form",{onSubmit:W(U),className:r.form,children:[e.jsx("input",{id:"hp_company",type:"text",tabIndex:-1,autoComplete:"off",style:{position:"absolute",left:"-10000px",top:"auto"},"aria-hidden":"true"}),e.jsx(u,{label:"Имя",...i("name",{required:"Имя обязательно для заполнения",minLength:{value:2,message:"Имя должно содержать минимум 2 символа"}}),error:c.name?.message}),e.jsx(u,{label:"Телефон",type:"tel",inputMode:"tel",autoComplete:"tel",placeholder:"+7 (999) 462-10-36",...i("phone",{required:"Телефон обязателен для заполнения",validate:s=>ue(s)||"Неверный формат телефона",onChange:s=>{const o=pe(s.target.value);x("phone",o,{shouldValidate:!0,shouldDirty:!0})}}),error:c.phone?.message}),e.jsx(u,{label:"Email (необязательно)",type:"email",inputMode:"email",autoComplete:"email",placeholder:"name@example.com",...i("email",{validate:s=>!s||ge(s)||"Неверный формат email"}),error:c.email?.message}),e.jsx(le,{name:"procedureId",control:S,rules:{required:"Выберите процедуру"},render:({field:s})=>O?e.jsxs("div",{style:{display:"grid",gap:6},children:[e.jsx("label",{style:{fontWeight:600,fontSize:14},children:"Процедура"}),e.jsx(ae,{height:56,radius:12})]}):e.jsx(xe,{label:"Процедура",options:V,...s,error:c.procedureId?.message})}),e.jsx(u,{label:"Желаемая дата",type:"date",...i("desiredDate",{required:"Укажите желаемую дату"}),error:c.desiredDate?.message}),e.jsx(u,{label:"Желаемое время",type:"time",...i("desiredTime",{required:"Укажите желаемое время"}),error:c.desiredTime?.message}),e.jsx(fe,{label:"Комментарий",...i("comment",{maxLength:{value:2e3,message:"Комментарий не должен превышать 2000 символов"}}),error:c.comment?.message}),e.jsxs("div",{className:r.checkbox,children:[e.jsx("input",{type:"checkbox",id:"consent",...i("consent",{required:"Необходимо согласие на обработку персональных данных"})}),e.jsxs("label",{htmlFor:"consent",children:["Я согласен(а) на обработку персональных данных."," ",e.jsx("a",{href:"/alla/privacy",target:"_blank",rel:"noopener noreferrer",children:"Политика конфиденциальности"})]}),c.consent&&e.jsx("span",{className:r.errorMessage,children:c.consent.message})]}),e.jsx(y,{type:"submit",size:"large",disabled:N,className:r.submitButton,children:N?"Отправка...":"Отправить заявку"})]})]})})})]})]})})]})};export{Oe as default};
