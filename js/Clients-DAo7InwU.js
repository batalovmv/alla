import{G as j,j as e,I as u,R as f,B as N}from"./index-DKxZk2j6.js";import{r as a,L as C}from"./react-vendor-BQWX9zlF.js";import{C as d}from"./Card-BwajGH-R.js";import"./redux-vendor-B8TTZsxA.js";import"./firebase-vendor-75UNovty.js";import"./form-vendor-BjD3cHyu.js";const v="_clients_1mxo9_1",I="_header_1mxo9_5",g="_title_1mxo9_14",w="_searchInput_1mxo9_20",y="_loading_1mxo9_26",R="_empty_1mxo9_34",E="_list_1mxo9_41",S="_clientCard_1mxo9_46",L="_clientHeader_1mxo9_50",b="_clientName_1mxo9_57",D="_clientPhone_1mxo9_63",H="_clientEmail_1mxo9_77",P="_clientInfo_1mxo9_92",A="_infoRow_1mxo9_99",T="_label_1mxo9_105",U="_actions_1mxo9_110",t={clients:v,header:I,title:g,searchInput:w,loading:y,empty:R,list:E,clientCard:S,clientHeader:L,clientName:b,clientPhone:D,clientEmail:H,clientInfo:P,infoRow:A,label:T,actions:U},q=()=>{const[i,m]=a.useState([]),[o,c]=a.useState([]),[h,r]=a.useState(!0),[l,x]=a.useState("");a.useEffect(()=>{_()},[]),a.useEffect(()=>{if(l.trim()==="")c(i);else{const s=l.toLowerCase(),p=i.filter(n=>n.name.toLowerCase().includes(s)||n.phone.includes(s)||n.email&&n.email.toLowerCase().includes(s));c(p)}},[l,i]);const _=async()=>{try{r(!0);const s=await j.getAll();m(s),c(s)}catch(s){console.error("Ошибка загрузки клиентов:",s)}finally{r(!1)}};return h?e.jsx("div",{className:t.loading,children:"Загрузка..."}):e.jsxs("div",{className:t.clients,children:[e.jsxs("div",{className:t.header,children:[e.jsx("h1",{className:t.title,children:"Клиенты"}),e.jsx(u,{type:"text",placeholder:"Поиск по имени, телефону или email...",value:l,onChange:s=>x(s.target.value),className:t.searchInput})]}),o.length===0?e.jsx(d,{className:t.empty,children:e.jsx("p",{children:l?"Клиенты не найдены":"Клиентов нет"})}):e.jsx("div",{className:t.list,children:o.map(s=>e.jsxs(d,{className:t.clientCard,children:[e.jsx("div",{className:t.clientHeader,children:e.jsxs("div",{children:[e.jsx("h3",{className:t.clientName,children:s.name}),e.jsx("p",{className:t.clientPhone,children:e.jsx("a",{href:`tel:${s.phone}`,children:s.phone})}),s.email&&e.jsx("p",{className:t.clientEmail,children:e.jsx("a",{href:`mailto:${s.email}`,children:s.email})})]})}),e.jsxs("div",{className:t.clientInfo,children:[e.jsxs("div",{className:t.infoRow,children:[e.jsx("span",{className:t.label,children:"Визитов:"}),e.jsx("span",{children:s.totalVisits||0})]}),s.lastVisit&&e.jsxs("div",{className:t.infoRow,children:[e.jsx("span",{className:t.label,children:"Последний визит:"}),e.jsx("span",{children:new Date(s.lastVisit).toLocaleDateString("ru-RU")})]}),e.jsxs("div",{className:t.infoRow,children:[e.jsx("span",{className:t.label,children:"Дата регистрации:"}),e.jsx("span",{children:new Date(s.createdAt).toLocaleDateString("ru-RU")})]})]}),e.jsx("div",{className:t.actions,children:e.jsx(C,{to:f.ADMIN_CLIENT_HISTORY(s.id),children:e.jsx(N,{size:"small",children:"История"})})})]},s.id))})]})};export{q as default};
