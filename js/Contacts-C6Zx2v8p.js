import{u as U,a as A,C as V,s as z,r as O,g as R,c as K,d as G,l as _,m as H,n as j,o as J,j as e,B as b,I as u}from"./index-DW3vkRHI.js";import{f as Q,r as t}from"./react-vendor-BQWX9zlF.js";import{u as X,a as Y,C as Z}from"./form-vendor-BjD3cHyu.js";import{f as ee,i as se,b as re}from"./cache-D_2N5j-Q.js";import{v as ae,a as te}from"./validation-tERvU4A4.js";import{C as L}from"./Card-n9Gd7p75.js";import{T as ne}from"./Textarea-BetE8on3.js";import{S as oe}from"./Select-lZNhoxA9.js";import{S as ce}from"./SEO-BoZ6cLnu.js";import"./redux-vendor-B8TTZsxA.js";import"./firebase-vendor-CGxEfUHl.js";const ie="_contacts_1nygq_1",le="_container_1nygq_6",me="_title_1nygq_11",de="_content_1nygq_19",he="_infoCard_1nygq_25",ue="_formCard_1nygq_26",pe="_contactItem_1nygq_37",ge="_social_1nygq_63",fe="_socialLinks_1nygq_75",xe="_map_1nygq_91",_e="_mapPlaceholder_1nygq_97",je="_mapNote_1nygq_109",be="_form_1nygq_26",ye="_checkbox_1nygq_120",ve="_successMessage_1nygq_138",ke="_errorMessage_1nygq_147",Ne="_submitButton_1nygq_153",r={contacts:ie,container:le,title:me,content:de,infoCard:he,formCard:ue,contactItem:pe,social:ge,socialLinks:fe,map:xe,mapPlaceholder:_e,mapNote:je,form:be,checkbox:ye,successMessage:ve,errorMessage:ke,submitButton:Ne},He=()=>{const n=U(),[y]=Q(),{items:o,lastFetched:v}=A(s=>s.procedures),{isSubmitting:k,success:g,error:N}=A(s=>s.booking),[a,$]=t.useState({...V,mapEmbedUrl:"",whatsappPhone:""}),{register:l,handleSubmit:F,formState:{errors:c},reset:I,setValue:M,control:q}=X({defaultValues:{consent:!1}}),f=Y({control:q,name:"procedureId"}),E=t.useCallback(async()=>{const s=await ee();n(z(s))},[n]);t.useEffect(()=>{(o.length===0||se(v,3e5))&&E()},[o.length,v,E]),t.useEffect(()=>{const s=y.get("procedureId");if(s&&o.length>0&&o.some(d=>d.id===s)){const d=setTimeout(()=>{M("procedureId",s,{shouldValidate:!0,shouldDirty:!0})},0);return()=>clearTimeout(d)}},[y,o,M]),t.useEffect(()=>{if(g){I();const s=setTimeout(()=>{n(O())},5e3);return()=>clearTimeout(s)}},[g,I,n]),t.useEffect(()=>{let s=!0;return R().then(i=>{s&&$(i)}).catch(()=>{}),()=>{s=!1}},[]);const D=t.useMemo(()=>o.map(s=>({value:s.id,label:`${s.name} - ${s.price} ₽`})),[o]),x=t.useMemo(()=>f&&o.find(i=>i.id===f)?.name||"",[o,f]),p=t.useMemo(()=>{if(a.whatsappEnabled===!1)return null;const s="Здравствуйте! Хочу записаться в A.K.beauty.",i=x?`${s} Процедура: "${x}".`:s;return K({whatsappPhone:a.whatsappPhone,text:i})},[a.whatsappEnabled,a.whatsappPhone,x]),m=t.useMemo(()=>G({telegramLink:a.socialMedia.telegram}),[a.socialMedia.telegram]),S=t.useMemo(()=>_(a.socialMedia.instagram),[a.socialMedia.instagram]),C=t.useMemo(()=>_(a.socialMedia.vk),[a.socialMedia.vk]),w=t.useMemo(()=>_(a.socialMedia.whatsapp),[a.socialMedia.whatsapp]),W=t.useCallback(async s=>{const i=document.getElementById("hp_company")?.value;if(i&&i.trim().length>0){n(H());return}const d=Date.now(),P=localStorage.getItem("booking_last_submit_ts"),B=P?Number(P):0;if(B&&d-B<6e4){n(j("Пожалуйста, подождите минуту и попробуйте снова."));return}n(J());try{const h=await re(s);h.success?(localStorage.setItem("booking_last_submit_ts",String(d)),n(H())):n(j(h.message||"Ошибка отправки"))}catch(h){n(j(h instanceof Error?h.message:"Произошла ошибка"))}},[n]),T=a.mapEmbedUrl||"";return e.jsxs(e.Fragment,{children:[e.jsx(ce,{title:"Контакты и запись",description:"Свяжитесь с нами или запишитесь на консультацию. Телефон, адрес, форма записи на сеанс.",keywords:"контакты косметолог, запись на процедуру, косметология контакты"}),e.jsx("div",{className:r.contacts,children:e.jsxs("div",{className:r.container,children:[e.jsx("h1",{className:r.title,children:"Контакты и запись"}),e.jsxs("div",{className:r.content,children:[e.jsx("div",{className:r.infoSection,children:e.jsxs(L,{className:r.infoCard,children:[e.jsx("h2",{children:"Контактная информация"}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Телефон:"}),e.jsx("a",{href:`tel:${a.phone}`,children:a.phone})]}),p&&e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"WhatsApp:"}),e.jsx("a",{href:p,target:"_blank",rel:"noopener noreferrer",children:"Написать в WhatsApp"})]}),m&&e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Telegram:"}),e.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:"Написать в Telegram"})]}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Email:"}),e.jsx("a",{href:`mailto:${a.email}`,children:a.email})]}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Адрес:"}),e.jsx("p",{children:a.address})]}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Часы работы:"}),e.jsx("p",{children:a.workingHours})]}),e.jsxs("div",{className:r.social,children:[e.jsx("h3",{children:"Социальные сети"}),e.jsxs("div",{className:r.socialLinks,children:[S&&e.jsx("a",{href:S,target:"_blank",rel:"noopener noreferrer",children:"Instagram"}),C&&e.jsx("a",{href:C,target:"_blank",rel:"noopener noreferrer",children:"VK"}),m&&e.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:"Telegram"}),w&&e.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",children:"WhatsApp"})]})]}),e.jsx("div",{className:r.map,children:T?e.jsx("iframe",{title:"Карта",src:T,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",style:{width:"100%",height:320,border:0,borderRadius:12}}):e.jsxs("div",{className:r.mapPlaceholder,children:[e.jsx("p",{children:"Карта местоположения"}),e.jsx("p",{className:r.mapNote,children:"Укажите VITE_MAP_EMBED_URL в .env.local (или заполните ссылку в админке → Контакты), чтобы встроить карту"})]})})]})}),e.jsx("div",{className:r.formSection,children:e.jsxs(L,{className:r.formCard,children:[e.jsx("h2",{children:"Записаться на сеанс"}),g&&e.jsxs("div",{className:r.successMessage,children:["✓ Ваша заявка успешно отправлена! Мы свяжемся с вами в ближайшее время.",p&&e.jsx("div",{style:{marginTop:12},children:e.jsx("a",{href:p,target:"_blank",rel:"noopener noreferrer",children:e.jsx(b,{variant:"outline",size:"small",children:"Написать в WhatsApp сейчас"})})}),m&&e.jsx("div",{style:{marginTop:12},children:e.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:e.jsx(b,{variant:"outline",size:"small",children:"Написать в Telegram сейчас"})})})]}),N&&e.jsxs("div",{className:r.errorMessage,children:["✗ ",N]}),e.jsxs("form",{onSubmit:F(W),className:r.form,children:[e.jsx("input",{id:"hp_company",type:"text",tabIndex:-1,autoComplete:"off",style:{position:"absolute",left:"-10000px",top:"auto"},"aria-hidden":"true"}),e.jsx(u,{label:"Имя",...l("name",{required:"Имя обязательно для заполнения",minLength:{value:2,message:"Имя должно содержать минимум 2 символа"}}),error:c.name?.message}),e.jsx(u,{label:"Телефон",type:"tel",...l("phone",{required:"Телефон обязателен для заполнения",validate:s=>ae(s)||"Неверный формат телефона"}),error:c.phone?.message}),e.jsx(u,{label:"Email",type:"email",...l("email",{validate:s=>!s||te(s)||"Неверный формат email"}),error:c.email?.message}),e.jsx(Z,{name:"procedureId",control:q,rules:{required:"Выберите процедуру"},render:({field:s})=>e.jsx(oe,{label:"Процедура",options:D,...s,error:c.procedureId?.message})}),e.jsx(u,{label:"Желаемая дата",type:"date",...l("desiredDate",{required:"Укажите желаемую дату"}),error:c.desiredDate?.message}),e.jsx(u,{label:"Желаемое время",type:"time",...l("desiredTime",{required:"Укажите желаемое время"}),error:c.desiredTime?.message}),e.jsx(ne,{label:"Комментарий",...l("comment",{maxLength:{value:2e3,message:"Комментарий не должен превышать 2000 символов"}}),error:c.comment?.message}),e.jsxs("div",{className:r.checkbox,children:[e.jsx("input",{type:"checkbox",id:"consent",...l("consent",{required:"Необходимо согласие на обработку персональных данных"})}),e.jsxs("label",{htmlFor:"consent",children:["Я согласен(а) на обработку персональных данных."," ",e.jsx("a",{href:"/alla/privacy",target:"_blank",rel:"noopener noreferrer",children:"Политика конфиденциальности"})]}),c.consent&&e.jsx("span",{className:r.errorMessage,children:c.consent.message})]}),e.jsx(b,{type:"submit",size:"large",disabled:k,className:r.submitButton,children:k?"Отправка...":"Отправить заявку"})]})]})})]})]})})]})};export{He as default};
