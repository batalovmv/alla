import{O as j,j as e,p as u,I as f,h as m,R as N,B as C}from"./index-BHi7tjzw.js";import{r as t,L as v}from"./react-vendor-BQWX9zlF.js";import"./redux-vendor-B8TTZsxA.js";import"./firebase-vendor-CGxEfUHl.js";import"./form-vendor-BjD3cHyu.js";const I="_clients_1mxo9_1",w="_header_1mxo9_5",y="_title_1mxo9_14",R="_searchInput_1mxo9_20",E="_empty_1mxo9_34",S="_list_1mxo9_41",g="_clientCard_1mxo9_46",L="_clientHeader_1mxo9_50",b="_clientName_1mxo9_57",D="_clientPhone_1mxo9_63",H="_clientEmail_1mxo9_77",P="_clientInfo_1mxo9_92",A="_infoRow_1mxo9_99",O="_label_1mxo9_105",T="_actions_1mxo9_110",a={clients:I,header:w,title:y,searchInput:R,empty:E,list:S,clientCard:g,clientHeader:L,clientName:b,clientPhone:D,clientEmail:H,clientInfo:P,infoRow:A,label:O,actions:T},Q=()=>{const[i,d]=t.useState([]),[o,c]=t.useState([]),[h,r]=t.useState(!0),[l,x]=t.useState("");t.useEffect(()=>{_()},[]),t.useEffect(()=>{if(l.trim()==="")c(i);else{const s=l.toLowerCase(),p=i.filter(n=>n.name.toLowerCase().includes(s)||n.phone.includes(s)||n.email&&n.email.toLowerCase().includes(s));c(p)}},[l,i]);const _=async()=>{try{r(!0);const s=await j.getAll();d(s),c(s)}catch(s){console.error("Ошибка загрузки клиентов:",s)}finally{r(!1)}};return h?e.jsx(u,{variant:"admin"}):e.jsxs("div",{className:a.clients,children:[e.jsxs("div",{className:a.header,children:[e.jsx("h1",{className:a.title,children:"Клиенты"}),e.jsx(f,{type:"text",placeholder:"Поиск по имени, телефону или email...",value:l,onChange:s=>x(s.target.value),className:a.searchInput})]}),o.length===0?e.jsx(m,{className:a.empty,children:e.jsx("p",{children:l?"Клиенты не найдены":"Клиентов нет"})}):e.jsx("div",{className:a.list,children:o.map(s=>e.jsxs(m,{className:a.clientCard,children:[e.jsx("div",{className:a.clientHeader,children:e.jsxs("div",{children:[e.jsx("h3",{className:a.clientName,children:s.name}),e.jsx("p",{className:a.clientPhone,children:e.jsx("a",{href:`tel:${s.phone}`,children:s.phone})}),s.email&&e.jsx("p",{className:a.clientEmail,children:e.jsx("a",{href:`mailto:${s.email}`,children:s.email})})]})}),e.jsxs("div",{className:a.clientInfo,children:[e.jsxs("div",{className:a.infoRow,children:[e.jsx("span",{className:a.label,children:"Визитов:"}),e.jsx("span",{children:s.totalVisits||0})]}),s.lastVisit&&e.jsxs("div",{className:a.infoRow,children:[e.jsx("span",{className:a.label,children:"Последний визит:"}),e.jsx("span",{children:new Date(s.lastVisit).toLocaleDateString("ru-RU")})]}),e.jsxs("div",{className:a.infoRow,children:[e.jsx("span",{className:a.label,children:"Дата регистрации:"}),e.jsx("span",{children:new Date(s.createdAt).toLocaleDateString("ru-RU")})]})]}),e.jsx("div",{className:a.actions,children:e.jsx(v,{to:N.ADMIN_CLIENT_HISTORY(s.id),children:e.jsx(C,{size:"small",children:"История"})})})]},s.id))})]})};export{Q as default};
