import{N as u,C as a,j as s,p as _,h as j,I as i,B as v}from"./index-ClPW3n0f.js";import{r as n}from"./react-vendor-BQWX9zlF.js";import{u as k}from"./form-vendor-BjD3cHyu.js";import"./redux-vendor-B8TTZsxA.js";import"./firebase-vendor-CGxEfUHl.js";const M="_contacts_amv71_1",y="_title_amv71_5",E="_card_amv71_15",S="_successMessage_amv71_19",N="_form_amv71_28",H="_sectionTitle_amv71_34",P="_actions_amv71_40",o={contacts:M,title:y,card:E,successMessage:S,form:N,sectionTitle:H,actions:P},A=()=>{const[h,m]=n.useState(!0),[p,d]=n.useState(!1),[w,c]=n.useState(!1),{register:r,handleSubmit:f,formState:{errors:t},reset:g}=k();n.useEffect(()=>{b()},[]);const b=async()=>{try{m(!0);const e=await u.get();g(e?{phone:e.phone||a.phone,whatsappPhone:e.whatsappPhone||"",email:e.email||a.email,address:e.address||a.address,workingHours:e.workingHours||a.workingHours,mapEmbedUrl:e.mapEmbedUrl||"",instagram:e.socialMedia?.instagram||a.socialMedia.instagram,vk:e.socialMedia?.vk||a.socialMedia.vk,telegram:e.socialMedia?.telegram||a.socialMedia.telegram,whatsapp:e.socialMedia?.whatsapp||a.socialMedia.whatsapp}:{phone:a.phone,whatsappPhone:"",email:a.email,address:a.address,workingHours:a.workingHours,mapEmbedUrl:"",instagram:a.socialMedia.instagram,vk:a.socialMedia.vk,telegram:a.socialMedia.telegram,whatsapp:a.socialMedia.whatsapp})}catch(e){console.error("Ошибка загрузки контактов:",e)}finally{m(!1)}},x=async e=>{d(!0),c(!1);try{await u.update({phone:e.phone,whatsappPhone:String(e.whatsappPhone||"").replace(/\D/g,""),email:e.email,address:e.address,workingHours:e.workingHours,mapEmbedUrl:e.mapEmbedUrl||"",socialMedia:{instagram:e.instagram,vk:e.vk,telegram:e.telegram,whatsapp:e.whatsapp}}),c(!0),setTimeout(()=>c(!1),3e3)}catch(l){console.error("Ошибка сохранения контактов:",l),alert("Ошибка при сохранении контактов")}finally{d(!1)}};return h?s.jsx(_,{variant:"admin"}):s.jsxs("div",{className:o.contacts,children:[s.jsx("h1",{className:o.title,children:"Редактирование контактов"}),s.jsxs(j,{className:o.card,children:[w&&s.jsx("div",{className:o.successMessage,children:"✓ Контакты успешно сохранены"}),s.jsxs("form",{onSubmit:f(x),className:o.form,children:[s.jsx(i,{label:"Телефон",...r("phone",{required:"Телефон обязателен"}),error:t.phone?.message}),s.jsx(i,{label:"WhatsApp номер (для wa.me, формат 7700..., без + и пробелов)",...r("whatsappPhone",{validate:e=>{if(!e)return!0;const l=String(e).replace(/\D/g,"");return l.length!==11?"Введите номер из 11 цифр (например 77001234567)":l.startsWith("7")?!0:"Номер должен начинаться с 7"}}),error:t.whatsappPhone?.message}),s.jsx(i,{label:"Email",type:"email",...r("email",{required:"Email обязателен"}),error:t.email?.message}),s.jsx(i,{label:"Адрес",...r("address",{required:"Адрес обязателен"}),error:t.address?.message}),s.jsx(i,{label:"Часы работы",...r("workingHours",{required:"Часы работы обязательны"}),error:t.workingHours?.message}),s.jsx(i,{label:"Ссылка для встраивания карты (iframe src)",type:"url",...r("mapEmbedUrl"),error:t.mapEmbedUrl?.message}),s.jsx("h3",{className:o.sectionTitle,children:"Социальные сети"}),s.jsx(i,{label:"Instagram",type:"url",...r("instagram"),error:t.instagram?.message}),s.jsx(i,{label:"VK",type:"url",...r("vk"),error:t.vk?.message}),s.jsx(i,{label:"Telegram",type:"url",...r("telegram"),error:t.telegram?.message}),s.jsx(i,{label:"WhatsApp",type:"url",...r("whatsapp"),error:t.whatsapp?.message}),s.jsx("div",{className:o.actions,children:s.jsx(v,{type:"submit",disabled:p,children:p?"Сохранение...":"Сохранить"})})]})]})]})};export{A as default};
