import{E as u,C as a,j as s,I as o,B as x}from"./index-ULYf0HN_.js";import{r as n}from"./react-vendor-BQWX9zlF.js";import{u as v}from"./form-vendor-BjD3cHyu.js";import{C as j}from"./Card-Dg84Exp1.js";import"./redux-vendor-B8TTZsxA.js";import"./firebase-vendor-CGxEfUHl.js";const k="_contacts_amv71_1",M="_title_amv71_5",y="_loading_amv71_10",E="_card_amv71_15",S="_successMessage_amv71_19",N="_form_amv71_28",H="_sectionTitle_amv71_34",T="_actions_amv71_40",i={contacts:k,title:M,loading:y,card:E,successMessage:S,form:N,sectionTitle:H,actions:T},W=()=>{const[h,c]=n.useState(!0),[p,d]=n.useState(!1),[f,m]=n.useState(!1),{register:r,handleSubmit:w,formState:{errors:t},reset:g}=v();n.useEffect(()=>{_()},[]);const _=async()=>{try{c(!0);const e=await u.get();g(e?{phone:e.phone||a.phone,whatsappPhone:e.whatsappPhone||"",email:e.email||a.email,address:e.address||a.address,workingHours:e.workingHours||a.workingHours,mapEmbedUrl:e.mapEmbedUrl||"",instagram:e.socialMedia?.instagram||a.socialMedia.instagram,vk:e.socialMedia?.vk||a.socialMedia.vk,telegram:e.socialMedia?.telegram||a.socialMedia.telegram,whatsapp:e.socialMedia?.whatsapp||a.socialMedia.whatsapp}:{phone:a.phone,whatsappPhone:"",email:a.email,address:a.address,workingHours:a.workingHours,mapEmbedUrl:"",instagram:a.socialMedia.instagram,vk:a.socialMedia.vk,telegram:a.socialMedia.telegram,whatsapp:a.socialMedia.whatsapp})}catch(e){console.error("Ошибка загрузки контактов:",e)}finally{c(!1)}},b=async e=>{d(!0),m(!1);try{await u.update({phone:e.phone,whatsappPhone:String(e.whatsappPhone||"").replace(/\D/g,""),email:e.email,address:e.address,workingHours:e.workingHours,mapEmbedUrl:e.mapEmbedUrl||"",socialMedia:{instagram:e.instagram,vk:e.vk,telegram:e.telegram,whatsapp:e.whatsapp}}),m(!0),setTimeout(()=>m(!1),3e3)}catch(l){console.error("Ошибка сохранения контактов:",l),alert("Ошибка при сохранении контактов")}finally{d(!1)}};return h?s.jsx("div",{className:i.loading,children:"Загрузка..."}):s.jsxs("div",{className:i.contacts,children:[s.jsx("h1",{className:i.title,children:"Редактирование контактов"}),s.jsxs(j,{className:i.card,children:[f&&s.jsx("div",{className:i.successMessage,children:"✓ Контакты успешно сохранены"}),s.jsxs("form",{onSubmit:w(b),className:i.form,children:[s.jsx(o,{label:"Телефон",...r("phone",{required:"Телефон обязателен"}),error:t.phone?.message}),s.jsx(o,{label:"WhatsApp номер (для wa.me, формат 7700..., без + и пробелов)",...r("whatsappPhone",{validate:e=>{if(!e)return!0;const l=String(e).replace(/\D/g,"");return l.length!==11?"Введите номер из 11 цифр (например 77001234567)":l.startsWith("7")?!0:"Номер должен начинаться с 7"}}),error:t.whatsappPhone?.message}),s.jsx(o,{label:"Email",type:"email",...r("email",{required:"Email обязателен"}),error:t.email?.message}),s.jsx(o,{label:"Адрес",...r("address",{required:"Адрес обязателен"}),error:t.address?.message}),s.jsx(o,{label:"Часы работы",...r("workingHours",{required:"Часы работы обязательны"}),error:t.workingHours?.message}),s.jsx(o,{label:"Ссылка для встраивания карты (iframe src)",type:"url",...r("mapEmbedUrl"),error:t.mapEmbedUrl?.message}),s.jsx("h3",{className:i.sectionTitle,children:"Социальные сети"}),s.jsx(o,{label:"Instagram",type:"url",...r("instagram"),error:t.instagram?.message}),s.jsx(o,{label:"VK",type:"url",...r("vk"),error:t.vk?.message}),s.jsx(o,{label:"Telegram",type:"url",...r("telegram"),error:t.telegram?.message}),s.jsx(o,{label:"WhatsApp",type:"url",...r("whatsapp"),error:t.whatsapp?.message}),s.jsx("div",{className:i.actions,children:s.jsx(x,{type:"submit",disabled:p,children:p?"Сохранение...":"Сохранить"})})]})]})]})};export{W as default};
