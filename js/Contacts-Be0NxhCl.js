import{u as F,a as w,C as D,s as W,r as H,g as V,c as z,d as O,l as T,m as _,n as R,j as e,B as j,I as h}from"./index-DkN5fU9C.js";import{f as U,r as n}from"./react-vendor-BQWX9zlF.js";import{u as K,a as G,C as J}from"./form-vendor-BjD3cHyu.js";import{f as Q,i as X,b as Y}from"./cache-D2zsF_Mc.js";import{v as Z,a as ee}from"./validation-tERvU4A4.js";import{C as P}from"./Card-DWm1SBSS.js";import{T as se}from"./Textarea-BZKq12RU.js";import{S as re}from"./Select-CJW8MvJr.js";import{S as ae}from"./SEO-CdUqQ8-b.js";import"./redux-vendor-B8TTZsxA.js";import"./firebase-vendor-75UNovty.js";const te="_contacts_1nygq_1",ne="_container_1nygq_6",oe="_title_1nygq_11",ce="_content_1nygq_19",ie="_infoCard_1nygq_25",le="_formCard_1nygq_26",me="_contactItem_1nygq_37",de="_social_1nygq_63",he="_socialLinks_1nygq_75",pe="_map_1nygq_91",ue="_mapPlaceholder_1nygq_97",ge="_mapNote_1nygq_109",fe="_form_1nygq_26",xe="_checkbox_1nygq_120",_e="_successMessage_1nygq_138",je="_errorMessage_1nygq_147",be="_submitButton_1nygq_153",r={contacts:te,container:ne,title:oe,content:ce,infoCard:ie,formCard:le,contactItem:me,social:de,socialLinks:he,map:pe,mapPlaceholder:ue,mapNote:ge,form:fe,checkbox:xe,successMessage:_e,errorMessage:je,submitButton:be},Te=()=>{const t=F(),[b]=U(),{items:o,lastFetched:y}=w(s=>s.procedures),{isSubmitting:v,success:g,error:N}=w(s=>s.booking),[a,B]=n.useState({...D,mapEmbedUrl:"",whatsappPhone:""}),{register:l,handleSubmit:A,formState:{errors:c},reset:k,setValue:I,control:M}=K({defaultValues:{consent:!1}}),f=G({control:M,name:"procedureId"}),q=n.useCallback(async()=>{const s=await Q();t(W(s))},[t]);n.useEffect(()=>{(o.length===0||X(y,3e5))&&q()},[o.length,y,q]),n.useEffect(()=>{const s=b.get("procedureId");if(s&&o.length>0&&o.some(m=>m.id===s)){const m=setTimeout(()=>{I("procedureId",s,{shouldValidate:!0,shouldDirty:!0})},0);return()=>clearTimeout(m)}},[b,o,I]),n.useEffect(()=>{if(g){k();const s=setTimeout(()=>{t(H())},5e3);return()=>clearTimeout(s)}},[g,k,t]),n.useEffect(()=>{let s=!0;return V().then(i=>{s&&B(i)}).catch(()=>{}),()=>{s=!1}},[]);const L=n.useMemo(()=>o.map(s=>({value:s.id,label:`${s.name} - ${s.price} ₽`})),[o]),x=n.useMemo(()=>f&&o.find(i=>i.id===f)?.name||"",[o,f]),p=n.useMemo(()=>{if(a.whatsappEnabled===!1)return null;const s="Здравствуйте! Хочу записаться в A.K.beauty.",i=x?`${s} Процедура: "${x}".`:s;return z({whatsappPhone:a.whatsappPhone,text:i})},[a.whatsappEnabled,a.whatsappPhone,x]),u=n.useMemo(()=>O({telegramLink:a.socialMedia.telegram}),[a.socialMedia.telegram]),$=n.useCallback(async s=>{const i=document.getElementById("hp_company")?.value;if(i&&i.trim().length>0){t(T());return}const m=Date.now(),C=localStorage.getItem("booking_last_submit_ts"),S=C?Number(C):0;if(S&&m-S<6e4){t(_("Пожалуйста, подождите минуту и попробуйте снова."));return}t(R());try{const d=await Y(s);d.success?(localStorage.setItem("booking_last_submit_ts",String(m)),t(T())):t(_(d.message||"Ошибка отправки"))}catch(d){t(_(d instanceof Error?d.message:"Произошла ошибка"))}},[t]),E=a.mapEmbedUrl||"";return e.jsxs(e.Fragment,{children:[e.jsx(ae,{title:"Контакты и запись",description:"Свяжитесь с нами или запишитесь на консультацию. Телефон, адрес, форма записи на сеанс.",keywords:"контакты косметолог, запись на процедуру, косметология контакты"}),e.jsx("div",{className:r.contacts,children:e.jsxs("div",{className:r.container,children:[e.jsx("h1",{className:r.title,children:"Контакты и запись"}),e.jsxs("div",{className:r.content,children:[e.jsx("div",{className:r.infoSection,children:e.jsxs(P,{className:r.infoCard,children:[e.jsx("h2",{children:"Контактная информация"}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Телефон:"}),e.jsx("a",{href:`tel:${a.phone}`,children:a.phone})]}),p&&e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"WhatsApp:"}),e.jsx("a",{href:p,target:"_blank",rel:"noopener noreferrer",children:"Написать в WhatsApp"})]}),u&&e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Telegram:"}),e.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",children:"Написать в Telegram"})]}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Email:"}),e.jsx("a",{href:`mailto:${a.email}`,children:a.email})]}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Адрес:"}),e.jsx("p",{children:a.address})]}),e.jsxs("div",{className:r.contactItem,children:[e.jsx("strong",{children:"Часы работы:"}),e.jsx("p",{children:a.workingHours})]}),e.jsxs("div",{className:r.social,children:[e.jsx("h3",{children:"Социальные сети"}),e.jsxs("div",{className:r.socialLinks,children:[a.socialMedia.instagram&&e.jsx("a",{href:a.socialMedia.instagram,target:"_blank",rel:"noopener noreferrer",children:"Instagram"}),a.socialMedia.vk&&e.jsx("a",{href:a.socialMedia.vk,target:"_blank",rel:"noopener noreferrer",children:"VK"}),a.socialMedia.telegram&&e.jsx("a",{href:a.socialMedia.telegram,target:"_blank",rel:"noopener noreferrer",children:"Telegram"}),a.socialMedia.whatsapp&&e.jsx("a",{href:a.socialMedia.whatsapp,target:"_blank",rel:"noopener noreferrer",children:"WhatsApp"})]})]}),e.jsx("div",{className:r.map,children:E?e.jsx("iframe",{title:"Карта",src:E,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",style:{width:"100%",height:320,border:0,borderRadius:12}}):e.jsxs("div",{className:r.mapPlaceholder,children:[e.jsx("p",{children:"Карта местоположения"}),e.jsx("p",{className:r.mapNote,children:"Укажите VITE_MAP_EMBED_URL в .env.local, чтобы встроить карту"})]})})]})}),e.jsx("div",{className:r.formSection,children:e.jsxs(P,{className:r.formCard,children:[e.jsx("h2",{children:"Записаться на сеанс"}),g&&e.jsxs("div",{className:r.successMessage,children:["✓ Ваша заявка успешно отправлена! Мы свяжемся с вами в ближайшее время.",p&&e.jsx("div",{style:{marginTop:12},children:e.jsx("a",{href:p,target:"_blank",rel:"noopener noreferrer",children:e.jsx(j,{variant:"outline",size:"small",children:"Написать в WhatsApp сейчас"})})}),u&&e.jsx("div",{style:{marginTop:12},children:e.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",children:e.jsx(j,{variant:"outline",size:"small",children:"Написать в Telegram сейчас"})})})]}),N&&e.jsxs("div",{className:r.errorMessage,children:["✗ ",N]}),e.jsxs("form",{onSubmit:A($),className:r.form,children:[e.jsx("input",{id:"hp_company",type:"text",tabIndex:-1,autoComplete:"off",style:{position:"absolute",left:"-10000px",top:"auto"},"aria-hidden":"true"}),e.jsx(h,{label:"Имя",...l("name",{required:"Имя обязательно для заполнения",minLength:{value:2,message:"Имя должно содержать минимум 2 символа"}}),error:c.name?.message}),e.jsx(h,{label:"Телефон",type:"tel",...l("phone",{required:"Телефон обязателен для заполнения",validate:s=>Z(s)||"Неверный формат телефона"}),error:c.phone?.message}),e.jsx(h,{label:"Email",type:"email",...l("email",{validate:s=>!s||ee(s)||"Неверный формат email"}),error:c.email?.message}),e.jsx(J,{name:"procedureId",control:M,rules:{required:"Выберите процедуру"},render:({field:s})=>e.jsx(re,{label:"Процедура",options:L,...s,error:c.procedureId?.message})}),e.jsx(h,{label:"Желаемая дата",type:"date",...l("desiredDate",{required:"Укажите желаемую дату"}),error:c.desiredDate?.message}),e.jsx(h,{label:"Желаемое время",type:"time",...l("desiredTime",{required:"Укажите желаемое время"}),error:c.desiredTime?.message}),e.jsx(se,{label:"Комментарий",...l("comment",{maxLength:{value:2e3,message:"Комментарий не должен превышать 2000 символов"}}),error:c.comment?.message}),e.jsxs("div",{className:r.checkbox,children:[e.jsx("input",{type:"checkbox",id:"consent",...l("consent",{required:"Необходимо согласие на обработку персональных данных"})}),e.jsxs("label",{htmlFor:"consent",children:["Я согласен(а) на обработку персональных данных."," ",e.jsx("a",{href:"/alla/privacy",target:"_blank",rel:"noopener noreferrer",children:"Политика конфиденциальности"})]}),c.consent&&e.jsx("span",{className:r.errorMessage,children:c.consent.message})]}),e.jsx(j,{type:"submit",size:"large",disabled:v,className:r.submitButton,children:v?"Отправка...":"Отправить заявку"})]})]})})]})]})})]})};export{Te as default};
